!function(a){"function"==typeof define&&define.amd?define(["jquery","./keyboard/keyboard-tree","fuelux/tree","./scroll"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c,require("./keyboard/keyboard-tree"),require("fuelux"),require("./scroll")),c}:a(jQuery)}(function(a){"use strict";a(document).ready(function(){function b(a){c(a.currentTarget)}function c(b){for(var c=a(b).find(".tree-branch"),d=0;d<c.length;d++){var e=c[d];if(""!==a(e).attr("src")){var f=a(e).children(".tree-branch-header"),g=a(f).children(".tree-branch-name");a(g).attr("href",a(e).attr("src"))}}for(var h=a(b).find(".tree-item"),i=0;i<h.length;i++){var j=h[i];if(""!==a(j).attr("src")){var k=a(j).children(".tree-item-name");a(k).attr("href",a(j).attr("src"))}}}function d(b){if(32===b.which||1===b.which){b.preventDefault(),b.stopPropagation();var c=a(this).find("input").prop("checked"),d=!c;a(this).find("input").prop("checked",d),g()}}function e(b){if(32===b.which||1===b.which){b.preventDefault(),b.stopPropagation();var c=a(this).find("input").prop("checked"),d=!c;a(this).find("input").prop({checked:d,indeterminate:!1});var e=a(this).closest(".tree-branch").find("input");e.each(function(){a(this).prop({checked:d,indeterminate:!1})}),g()}}function f(b){var c=b.currentTarget,d=a(c).parent();if(a(d).hasClass("tree-branch-name")||a(d).hasClass("tree-branch-header")){var e=d.closest("li");if(!a(e).hasClass("tree-open")){var f=d.closest("ul.tree"),g=f.get(0).clientHeight,h=e.find("ul li").size(),i=a(d).get(0).offsetHeight,j=a(c).offset().top-f.offset().top,k=0===h&&j>3*g/4;(j+(h+1)*i>g||k)&&f.mCustomScrollbar("scrollTo",c,{scrollInertia:0})}}}function g(){a(".tree-branch-name > .checkbox > input[name='folder']").each(function(){var b=[];if(a(this).closest(".tree-branch").find("input[name='file']").each(function(){b.push(a(this).prop("checked"))}),0!==b.length){var c=b.reduce(function(a,b){return a&&b}),d=b.reduce(function(a,b){return a||b});a(this).prop("checked",c),c?a(this).prop({checked:!0,indeterminate:!1}):d?a(this).prop({checked:!1,indeterminate:!0}):a(this).prop({checked:!1,indeterminate:!1})}})}void 0!==a.fn.tree&&(a.fn.tree.Constructor.prototype.disable=function(){var b=this;b.$element.addClass("disabled-tree"),b.$element.find("a").each(function(){a(this).removeAttr("href"),a(this).attr("disabled","disabled")}),b.$element.find("input").attr("disabled","disabled"),b.$element.off("click.fu.tree",".tree-branch-name"),b.$element.find(".mCSB_scrollTools").length>0&&(b.$element.mCustomScrollbar("destroy"),b.$element.mCustomScrollbar({axis:"yx",advanced:{autoExpandHorizontalScroll:!0},alwaysShowScrollbar:2,theme:"disabled",mouseWheel:{enable:!1,axis:"x"}}),b.$element.mCustomScrollbar("disable"))},a.fn.tree.Constructor.prototype.enableScrollbar=function(a,b,c){var d=this;d.$element.nScrollbar({axis:c,setWidth:a,setHeight:b,advanced:{autoExpandHorizontalScroll:!0}})},a.fn.tree.Constructor.prototype.populate=function(b){var c=this,d=b.hasClass("tree")?b:b.parent(),e=d.find(".tree-loader:eq(0)"),f=d.data();e.removeClass("hide hidden"),this.options.dataSource(f?f:{},function(f){e.addClass("hidden"),a.each(f.data,function(e,f){var g;"folder"===f.type?(g=c.$element.find("[data-template=treebranch]:eq(0)").clone().removeClass("hide hidden").removeData("template"),g.data(f),g.find(".tree-branch-name > .tree-label").html(f.text||f.name)):"item"===f.type&&(g=c.$element.find("[data-template=treeitem]:eq(0)").clone().removeClass("hide hidden").removeData("template"),g.find(".tree-item-name > .tree-label").html(f.text||f.name),g.data(f)),f.desc&&g.find(".tree-label").append("<span class='tree-description'> &ndash; "+f.desc+"</span>"),f.icon&&g.find(".tree-label").append("<span class='icon "+f.icon+"'></span>");var h=f.attr||f.dataAttributes||[];a.each(h,function(a,b){switch(a){case"cssClass":case"class":case"className":g.addClass(b);break;case"data-icon":g.find(".icon-item").removeClass().addClass("icon-item "+b),g.attr(a,b);break;case"id":g.attr(a,b),g.attr("aria-labelledby",b+"-label");break;default:g.attr(a,b)}}),b.hasClass("tree-branch-header")?d.find(".tree-branch-children:eq(0)").append(g):b.append(g)}),c.$element.trigger("loaded.fu.tree",d)})}),setTimeout(function(){for(var d=a(".tree"),e=0;e<d.length;e++)c(d[e]),a(d[e]).on("click",b)},500),a(document).on("keydown",".tree-has-checkbox li.tree-item .checkbox[name='file']",d).on("click",".tree-has-checkbox li.tree-item .checkbox[name='file']",d).on("keydown",".tree-has-checkbox li.tree-branch .checkbox[name='folder']",e).on("click",".tree-has-checkbox li.tree-branch .checkbox[name='folder']",e).on("click.fu.tree",".tree .icon-caret",function(a){f(a)}).on("click.fu.tree",".tree .tree-label",function(a){f(a)})})});